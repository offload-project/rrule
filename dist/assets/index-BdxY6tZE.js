(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();const F=(r,t,e,n=0,i=0,s=0)=>new Date(Date.UTC(r,t-1,e,n,i,s)),zt=[31,28,31,30,31,30,31,31,30,31,30,31],_t=864e5,Nt=F(1970,1,1),Kt=[6,0,1,2,3,4,5],V=r=>r%4==0&&r%100!=0||r%400==0,at=r=>((t,e)=>{const n=t.getTime()-e.getTime();return Math.round(n/_t)})(r,Nt),Wt=r=>new Date(Nt.getTime()+r*_t),Pt=r=>{const t=r.getUTCMonth();return t===1&&V(r.getUTCFullYear())?29:zt[t]},X=r=>Kt[r.getUTCDay()],gt=(r,t)=>{const e=F(r,t+1,1);return[X(e),Pt(e)]},Ht=(r,t)=>(t=t||r,new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))),dt=r=>new Date(r.getTime()),kt=r=>{const t=[];for(const e of r)t.push(dt(e));return t},J=r=>{r.sort((t,e)=>t.getTime()-e.getTime())},ft=(r,t=!0)=>{const e=new Date(r);return[String(e.getUTCFullYear()).padStart(4,"0"),String(e.getUTCMonth()+1).padStart(2,"0"),String(e.getUTCDate()).padStart(2,"0"),"T",String(e.getUTCHours()).padStart(2,"0"),String(e.getUTCMinutes()).padStart(2,"0"),String(e.getUTCSeconds()).padStart(2,"0"),t?"Z":""].join("")},mt=r=>{const t=/^(\d{4})(\d{2})(\d{2})(T(\d{2})(\d{2})(\d{2})Z?)?$/.exec(r);if(!t)throw new Error(`Invalid UNTIL value: ${r}`);return new Date(Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[5],10)||0,parseInt(t[6],10)||0,parseInt(t[7],10)||0))},Et=(r,t)=>`${r.toLocaleString("sv-SE",{timeZone:t}).replace(" ","T")}Z`;class tt{date;tzid;constructor(t,e){if(Number.isNaN(t.getTime()))throw new RangeError("Invalid date passed to DateWithZone");this.date=t,this.tzid=e}get isUTC(){return!this.tzid||this.tzid.toUpperCase()==="UTC"}toString(){const t=ft(this.date.getTime(),this.isUTC);return this.isUTC?`:${t}`:`;TZID=${this.tzid}:${t}`}getTime(){return this.date.getTime()}rezonedDate(){return this.isUTC?this.date:((t,e)=>{const n=Intl.DateTimeFormat().resolvedOptions().timeZone,i=new Date(Et(t,n)),s=new Date(Et(t,e??"UTC")).getTime()-i.getTime();return new Date(t.getTime()-s)})(this.date,this.tzid)}}const et=["MO","TU","WE","TH","FR","SA","SU"];class L{weekday;n;constructor(t,e){if(e===0)throw new Error("Can't create weekday with n == 0");this.weekday=t,this.n=e}static fromStr(t){return new L(et.indexOf(t))}nth(t){return this.n===t?this:new L(this.weekday,t)}equals(t){return this.weekday===t.weekday&&this.n===t.n}toString(){let t=et[this.weekday];return this.n&&(t=(this.n>0?"+":"")+String(this.n)+t),t}getJsWeekday(){return this.weekday===6?0:this.weekday+1}}const qt=r=>r instanceof Date,Q=r=>qt(r)&&!Number.isNaN(r.getTime()),U=r=>r!=null,W=r=>typeof r=="number",Tt=r=>typeof r=="string"&&et.includes(r),_=Array.isArray,q=(r,t)=>{t===void 0&&(t=r,r=0);const e=[];for(let n=r;n<t;n++)e.push(n);return e},g=(r,t)=>{let e=0;const n=[];if(_(r))for(;e<t;e++)n[e]=[].concat(r);else for(;e<t;e++)n[e]=r;return n},Bt=r=>_(r)?r:[r],$=(r,t)=>{const e=r%t;return e*t<0?e+t:e},ot=(r,t)=>({div:Math.floor(r/t),mod:$(r,t)}),H=r=>!U(r)||r.length===0,O=r=>!H(r);var k=(r=>(r[r.YEARLY=0]="YEARLY",r[r.MONTHLY=1]="MONTHLY",r[r.WEEKLY=2]="WEEKLY",r[r.DAILY=3]="DAILY",r[r.HOURLY=4]="HOURLY",r[r.MINUTELY=5]="MINUTELY",r[r.SECONDLY=6]="SECONDLY",r))(k||{});function ct(r){return r<4}class nt{hour;minute;second;millisecond;constructor(t,e,n,i){this.hour=t,this.minute=e,this.second=n,this.millisecond=i||0}getHours(){return this.hour}getMinutes(){return this.minute}getSeconds(){return this.second}getMilliseconds(){return this.millisecond}getTime(){return 1e3*(60*this.hour*60+60*this.minute+this.second)+this.millisecond}}class bt extends nt{day;month;year;static fromDate(t){return new bt(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.valueOf()%1e3)}constructor(t,e,n,i,s,a,o){super(i,s,a,o),this.year=t,this.month=e,this.day=n}getWeekday(){return X(new Date(this.getTime()))}getTime(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond)).getTime()}getDay(){return this.day}getMonth(){return this.month}getYear(){return this.year}addYears(t){this.year+=t}addMonths(t){if(this.month+=t,this.month>12){const e=Math.floor(this.month/12);this.month=$(this.month,12),this.year+=e,this.month===0&&(this.month=12,--this.year)}}addWeekly(t,e){e>this.getWeekday()?this.day+=-(this.getWeekday()+1+(6-e))+7*t:this.day+=-(this.getWeekday()-e)+7*t,this.fixDay()}addDaily(t){this.day+=t,this.fixDay()}addHours(t,e,n){for(e&&(this.hour+=Math.floor((23-this.hour)/t)*t);;){this.hour+=t;const{div:i,mod:s}=ot(this.hour,24);if(i&&(this.hour=s,this.addDaily(i)),H(n)||n.includes(this.hour))break}}addMinutes(t,e,n,i){for(e&&(this.minute+=Math.floor((1439-(60*this.hour+this.minute))/t)*t);;){this.minute+=t;const{div:s,mod:a}=ot(this.minute,60);if(s&&(this.minute=a,this.addHours(s,!1,n)),(H(n)||n.includes(this.hour))&&(H(i)||i.includes(this.minute)))break}}addSeconds(t,e,n,i,s){for(e&&(this.second+=Math.floor((86399-(3600*this.hour+60*this.minute+this.second))/t)*t);;){this.second+=t;const{div:a,mod:o}=ot(this.second,60);if(a&&(this.second=o,this.addMinutes(a,!1,n,i)),(H(n)||n.includes(this.hour))&&(H(i)||i.includes(this.minute))&&(H(s)||s.includes(this.second)))break}}fixDay(){if(this.day<=28)return;let t=gt(this.year,this.month-1)[1];if(!(this.day<=t))for(;this.day>t;){if(this.day-=t,++this.month,this.month===13&&(this.month=1,++this.year,this.year>9999))return;t=gt(this.year,this.month-1)[1]}}add(t,e){const{freq:n,interval:i,wkst:s,byhour:a,byminute:o,bysecond:c}=t;switch(n){case k.YEARLY:return this.addYears(i);case k.MONTHLY:return this.addMonths(i);case k.WEEKLY:return this.addWeekly(i,s);case k.DAILY:return this.addDaily(i);case k.HOURLY:return this.addHours(i,e,a);case k.MINUTELY:return this.addMinutes(i,e,a,o);case k.SECONDLY:return this.addSeconds(i,e,a,o,c)}}}const Zt=[...g(1,31),...g(2,28),...g(3,31),...g(4,30),...g(5,31),...g(6,30),...g(7,31),...g(8,31),...g(9,30),...g(10,31),...g(11,30),...g(12,31),...g(1,7)],Xt=[...g(1,31),...g(2,29),...g(3,31),...g(4,30),...g(5,31),...g(6,30),...g(7,31),...g(8,31),...g(9,30),...g(10,31),...g(11,30),...g(12,31),...g(1,7)],Gt=q(1,29),Qt=q(1,30),z=q(1,31),Y=q(1,32),Vt=[...Y,...Qt,...Y,...z,...Y,...z,...Y,...Y,...z,...Y,...z,...Y,...Y.slice(0,7)],Jt=[...Y,...Gt,...Y,...z,...Y,...z,...Y,...Y,...z,...Y,...z,...Y,...Y.slice(0,7)],te=q(-28,0),ee=q(-29,0),K=q(-30,0),R=q(-31,0),ne=[...R,...ee,...R,...K,...R,...K,...R,...R,...K,...R,...K,...R,...R.slice(0,7)],se=[...R,...te,...R,...K,...R,...K,...R,...R,...K,...R,...K,...R,...R.slice(0,7)],re=[0,31,60,91,121,152,182,213,244,274,305,335,366],ie=[0,31,59,90,120,151,181,212,243,273,304,334,365],xt=(()=>{let r=[];for(let t=0;t<55;t++)r=r.concat(q(7));return r})();function ae(r){const t=V(r)?366:365,e=F(r,1,1),n=X(e);return t===365?{mmask:Zt,mdaymask:Jt,nmdaymask:se,wdaymask:xt.slice(n),mrange:ie}:{mmask:Xt,mdaymask:Vt,nmdaymask:ne,wdaymask:xt.slice(n),mrange:re}}class oe{constructor(t){this.options=t}yearinfo;monthinfo;eastermask;rebuild(t,e){const n=this.options;if(t!==this.lastyear&&(this.yearinfo=(function(i,s){const a=F(i,1,1),o=V(i)?366:365,c=V(i+1)?366:365,d=at(a),h=X(a),u={yearlen:o,nextyearlen:c,yearordinal:d,yearweekday:h,...ae(i),wnomask:null};if(H(s.byweekno))return u;let l,y;u.wnomask=g(0,o+7),l=$(7-h+s.wkst,7);let m=l;m>=4?(m=0,y=u.yearlen+$(h-s.wkst,7)):y=o-m;const p=Math.floor(y/7),E=$(y,7),S=Math.floor(p+E/4);for(let b of s.byweekno){if(b<0&&(b+=S+1),!(b>0&&b<=S))continue;let w;b>1?(w=m+7*(b-1),m!==l&&(w-=7-l)):w=m;for(let D=0;D<7&&(u.wnomask[w]=1,w++,u.wdaymask[w]!==s.wkst);D++);}if(s.byweekno.includes(1)){let b=m+7*S;if(m!==l&&(b-=7-l),b<o)for(let w=0;w<7&&(u.wnomask[b]=1,b+=1,u.wdaymask[b]!==s.wkst);w++);}if(m){let b;if(s.byweekno.includes(-1))b=-1;else{const w=X(F(i-1,1,1)),D=$(7-w.valueOf()+s.wkst,7),T=V(i-1)?366:365;let v;v=D>=4?T+$(w-s.wkst,7):o-m,b=Math.floor(52+$(v,7)/4)}if(s.byweekno.includes(b))for(let w=0;w<m;w++)u.wnomask[w]=1}return u})(t,n)),O(n.bynweekday)&&(e!==this.lastmonth||t!==this.lastyear)){const{yearlen:i,mrange:s,wdaymask:a}=this.yearinfo;this.monthinfo=(function(o,c,d,h,u,l){const y={lastyear:o,lastmonth:c,nwdaymask:[]};let m=[];if(l.freq===f.YEARLY)if(H(l.bymonth))m=[[0,d]];else for(const p of l.bymonth)c=p,m.push(h.slice(c-1,c+1));else l.freq===f.MONTHLY&&(m=[h.slice(c-1,c+1)]);if(H(m))return y;y.nwdaymask=g(0,d);for(const p of m){const[E,S]=p,b=S-1;for(const[w,D]of l.bynweekday){let T;D<0?(T=b+7*(D+1),T-=$(u[T]-w,7)):(T=E+7*(D-1),T+=$(7-u[T]+w,7)),E<=T&&T<=b&&(y.nwdaymask[T]=1)}}return y})(t,e,i,s,a,n)}U(n.byeaster)&&(this.eastermask=(function(i,s=0){const a=i%19,o=Math.floor(i/100),c=i%100,d=Math.floor(o/4),h=o%4,u=Math.floor((o+8)/25),l=Math.floor((o-u+1)/3),y=Math.floor(19*a+o-d-l+15)%30,m=Math.floor(c/4),p=c%4,E=Math.floor(32+2*h+2*m-y-p)%7,S=Math.floor((a+11*y+22*E)/451),b=Math.floor((y+E-7*S+114)/31),w=(y+E-7*S+114)%31+1,D=Date.UTC(i,b-1,w+s),T=Date.UTC(i,0,1);return[Math.ceil((D-T)/864e5)]})(t,n.byeaster))}get lastyear(){return this.monthinfo?this.monthinfo.lastyear:null}get lastmonth(){return this.monthinfo?this.monthinfo.lastmonth:null}get yearlen(){return this.yearinfo.yearlen}get yearordinal(){return this.yearinfo.yearordinal}get mrange(){return this.yearinfo.mrange}get wdaymask(){return this.yearinfo.wdaymask}get mmask(){return this.yearinfo.mmask}get wnomask(){return this.yearinfo.wnomask}get nwdaymask(){return this.monthinfo?this.monthinfo.nwdaymask:[]}get nextyearlen(){return this.yearinfo.nextyearlen}get mdaymask(){return this.yearinfo.mdaymask}get nmdaymask(){return this.yearinfo.nmdaymask}ydayset(){return[q(this.yearlen),0,this.yearlen]}mdayset(t,e){const n=this.mrange[e-1],i=this.mrange[e],s=g(null,this.yearlen);for(let a=n;a<i;a++)s[a]=a;return[s,n,i]}wdayset(t,e,n){const i=g(null,this.yearlen+7);let s=at(F(t,e,n))-this.yearordinal;const a=s;for(let o=0;o<7&&(i[s]=s,++s,this.wdaymask[s]!==this.options.wkst);o++);return[i,a,s]}ddayset(t,e,n){const i=g(null,this.yearlen),s=at(F(t,e,n))-this.yearordinal;return i[s]=s,[i,s,s+1]}htimeset(t,e,n,i){let s=[];return this.options.byminute.forEach(a=>{s=s.concat(this.mtimeset(t,a,n,i))}),J(s),s}mtimeset(t,e,n,i){const s=this.options.bysecond.map(a=>new nt(t,e,a,i));return J(s),s}stimeset(t,e,n,i){return[new nt(t,e,n,i)]}getdayset(t){switch(t){case k.YEARLY:return this.ydayset.bind(this);case k.MONTHLY:return this.mdayset.bind(this);case k.WEEKLY:return this.wdayset.bind(this);case k.DAILY:default:return this.ddayset.bind(this)}}gettimeset(t){switch(t){case k.HOURLY:return this.htimeset.bind(this);case k.MINUTELY:return this.mtimeset.bind(this);case k.SECONDLY:return this.stimeset.bind(this)}}}function ce(r,t,e,n,i,s){const a=[];for(const o of r){let c,d;o<0?(c=Math.floor(o/t.length),d=$(o,t.length)):(c=Math.floor((o-1)/t.length),d=$(o-1,t.length));const h=[];for(let p=e;p<n;p++){const E=s[p];U(E)&&h.push(E)}let u;u=c<0?h.slice(c)[0]:h[c];const l=t[d],y=Wt(i.yearordinal+u),m=Ht(y,l);a.includes(m)||a.push(m)}return J(a),a}function jt(r,t){const{dtstart:e,freq:n,interval:i,until:s,bysetpos:a}=t;let o=t.count;if(o===0||i===0)return j(r);const c=bt.fromDate(e),d=new oe(t);d.rebuild(c.year,c.month);let h=(function(u,l,y){const{freq:m,byhour:p,byminute:E,bysecond:S}=y;return ct(m)?(function(b){const w=b.dtstart.getTime()%1e3;if(!ct(b.freq))return[];const D=[];return b.byhour.forEach(T=>{b.byminute.forEach(v=>{b.bysecond.forEach(B=>{D.push(new nt(T,v,B,w))})})}),D})(y):m>=f.HOURLY&&O(p)&&!p.includes(l.hour)||m>=f.MINUTELY&&O(E)&&!E.includes(l.minute)||m>=f.SECONDLY&&O(S)&&!S.includes(l.second)?[]:u.gettimeset(m)(l.hour,l.minute,l.second,l.millisecond)})(d,c,t);for(;;){const[u,l,y]=d.getdayset(n)(c.year,c.month,c.day),m=le(u,l,y,d,t);if(O(a)){const p=ce(a,h,l,y,d,u);for(const E of p){if(s&&E>s)return j(r);if(E>=e){const S=St(E,t);if(!r.accept(S)||o&&(--o,!o))return j(r)}}}else for(let p=l;p<y;p++){const E=u[p];if(!U(E))continue;const S=Wt(d.yearordinal+E);for(const b of h){const w=Ht(S,b);if(s&&w>s)return j(r);if(w>=e){const D=St(w,t);if(!r.accept(D)||o&&(--o,!o))return j(r)}}}if(c.add(t,m),c.year>9999)return j(r);ct(n)||(h=d.gettimeset(n)(c.hour,c.minute,c.second,0)),d.rebuild(c.year,c.month)}}function he(r,t,e){const{bymonth:n,byweekno:i,byweekday:s,byeaster:a,bymonthday:o,bynmonthday:c,byyearday:d}=e;return O(n)&&!n.includes(r.mmask[t])||O(i)&&!r.wnomask[t]||O(s)&&!s.includes(r.wdaymask[t])||O(r.nwdaymask)&&!r.nwdaymask[t]||a!==null&&!r.eastermask?.includes(t)||(O(o)||O(c))&&!o.includes(r.mdaymask[t])&&!c.includes(r.nmdaymask[t])||O(d)&&(t<r.yearlen&&!d.includes(t+1)&&!d.includes(-r.yearlen+t)||t>=r.yearlen&&!d.includes(t+1-r.yearlen)&&!d.includes(-r.nextyearlen+t-r.yearlen))}function St(r,t){return new tt(r,t.tzid).rezonedDate()}function j(r){return r.getValue()}function le(r,t,e,n,i){let s=!1;for(let a=t;a<e;a++){const o=r[a];he(n,o,i)&&(s=!0,r[o]=null)}return s}const st={dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^weekdays?/i,"week(s)":/^weeks?/i,"hour(s)":/^hours?/i,"minute(s)":/^minutes?/i,"month(s)":/^months?/i,"year(s)":/^years?/i,on:/^(on|in)/i,at:/^(at)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,for:/^for/i,"time(s)":/^times?/i,until:/^(un)?til/i,monday:/^mo(n(day)?)?/i,tuesday:/^tu(e(s(day)?)?)?/i,wednesday:/^we(d(n(esday)?)?)?/i,thursday:/^th(u(r(sday)?)?)?/i,friday:/^fr(i(day)?)?/i,saturday:/^sa(t(urday)?)?/i,sunday:/^su(n(day)?)?/i,january:/^jan(uary)?/i,february:/^feb(ruary)?/i,march:/^mar(ch)?/i,april:/^apr(il)?/i,may:/^may/i,june:/^june?/i,july:/^july?/i,august:/^aug(ust)?/i,september:/^sep(t(ember)?)?/i,october:/^oct(ober)?/i,november:/^nov(ember)?/i,december:/^dec(ember)?/i,comma:/^(,\s*|(and|or)\s*)+/i}};class de{rules;text;symbol;value;done=!0;constructor(t){this.rules=t}start(t){return this.text=t,this.done=!1,this.nextSymbol()}isDone(){return this.done&&this.symbol===null}nextSymbol(){let t,e=null;this.symbol=null,this.value=null;do{if(this.done)return!1;let n;t=null;for(const i in this.rules){n=this.rules[i];const s=n.exec(this.text);s&&(t===null||s[0].length>t[0].length)&&(t=s,e=i)}if(t!=null&&(this.text=this.text.substr(t[0].length),this.text===""&&(this.done=!0)),t==null)return this.done=!0,this.symbol=null,void(this.value=null)}while(e==="SKIP");return this.symbol=e,this.value=t,!0}accept(t){if(this.symbol===t){if(this.value){const e=this.value;return this.nextSymbol(),e}return this.nextSymbol(),!0}return!1}acceptNumber(){return this.accept("number")}expect(t){if(this.accept(t))return!0;throw new Error(`expected ${t} but found ${this.symbol}`)}}function Dt(r,t=st){const e={},n=new de(t.tokens);return n.start(r)?((function(){n.expect("every");const h=n.acceptNumber();if(h&&(e.interval=parseInt(h[0],10)),n.isDone())throw new Error("Unexpected end");switch(n.symbol){case"day(s)":e.freq=f.DAILY,n.nextSymbol()&&(s(),d());break;case"weekday(s)":e.freq=f.WEEKLY,e.byweekday=[f.MO,f.TU,f.WE,f.TH,f.FR],n.nextSymbol(),s(),d();break;case"week(s)":e.freq=f.WEEKLY,n.nextSymbol()&&(i(),s(),d());break;case"hour(s)":e.freq=f.HOURLY,n.nextSymbol()&&(i(),d());break;case"minute(s)":e.freq=f.MINUTELY,n.nextSymbol()&&(i(),d());break;case"month(s)":e.freq=f.MONTHLY,n.nextSymbol()&&(i(),d());break;case"year(s)":e.freq=f.YEARLY,n.nextSymbol()&&(i(),d());break;case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":{e.freq=f.WEEKLY;const u=n.symbol.substr(0,2).toUpperCase();if(e.byweekday=[f[u]],!n.nextSymbol())return;for(;n.accept("comma");){if(n.isDone())throw new Error("Unexpected end");const l=o();if(!l)throw new Error(`Unexpected symbol ${n.symbol}, expected weekday`);e.byweekday.push(f[l]),n.nextSymbol()}s(),(function(){n.accept("on"),n.accept("the");let l=c();if(l)for(e.bymonthday=[l],n.nextSymbol();n.accept("comma");){if(l=c(),!l)throw new Error(`Unexpected symbol ${n.symbol}; expected monthday`);e.bymonthday.push(l),n.nextSymbol()}})(),d();break}case"january":case"february":case"march":case"april":case"may":case"june":case"july":case"august":case"september":case"october":case"november":case"december":if(e.freq=f.YEARLY,e.bymonth=[a()],!n.nextSymbol())return;for(;n.accept("comma");){if(n.isDone())throw new Error("Unexpected end");const u=a();if(!u)throw new Error(`Unexpected symbol ${n.symbol}, expected month`);e.bymonth.push(u),n.nextSymbol()}i(),d();break;default:throw new Error("Unknown symbol")}})(),e):null;function i(){const h=n.accept("on"),u=n.accept("the");if(h||u)do{const l=c(),y=o(),m=a();if(l)y?(n.nextSymbol(),e.byweekday||(e.byweekday=[]),e.byweekday.push(f[y].nth(l))):(e.bymonthday||(e.bymonthday=[]),e.bymonthday.push(l),n.accept("day(s)"));else if(y)n.nextSymbol(),e.byweekday||(e.byweekday=[]),e.byweekday.push(f[y]);else if(n.symbol==="weekday(s)")n.nextSymbol(),e.byweekday||(e.byweekday=[f.MO,f.TU,f.WE,f.TH,f.FR]);else if(n.symbol==="week(s)"){n.nextSymbol();let p=n.acceptNumber();if(!p)throw new Error(`Unexpected symbol ${n.symbol}, expected week number`);for(e.byweekno=[parseInt(p[0],10)];n.accept("comma");){if(p=n.acceptNumber(),!p)throw new Error(`Unexpected symbol ${n.symbol}; expected monthday`);e.byweekno.push(parseInt(p[0],10))}}else{if(!m)return;n.nextSymbol(),e.bymonth||(e.bymonth=[]),e.bymonth.push(m)}}while(n.accept("comma")||n.accept("the")||n.accept("on"))}function s(){if(n.accept("at"))do{let h=n.acceptNumber();if(!h)throw new Error(`Unexpected symbol ${n.symbol}, expected hour`);for(e.byhour=[parseInt(h[0],10)];n.accept("comma");){if(h=n.acceptNumber(),!h)throw new Error(`Unexpected symbol ${n.symbol}; expected hour`);e.byhour.push(parseInt(h[0],10))}}while(n.accept("comma")||n.accept("at"))}function a(){switch(n.symbol){case"january":return 1;case"february":return 2;case"march":return 3;case"april":return 4;case"may":return 5;case"june":return 6;case"july":return 7;case"august":return 8;case"september":return 9;case"october":return 10;case"november":return 11;case"december":return 12;default:return!1}}function o(){switch(n.symbol){case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":return n.symbol.substr(0,2).toUpperCase();default:return!1}}function c(){switch(n.symbol){case"last":return n.nextSymbol(),-1;case"first":return n.nextSymbol(),1;case"second":return n.nextSymbol(),n.accept("last")?-2:2;case"third":return n.nextSymbol(),n.accept("last")?-3:3;case"nth":{const h=parseInt(n.value[1],10);if(h<-366||h>366)throw new Error(`Nth out of range: ${h}`);return n.nextSymbol(),n.accept("last")?-h:h}default:return!1}}function d(){if(n.symbol==="until"){const h=Date.parse(n.text);if(!h)throw new Error(`Cannot parse until date:${n.text}`);e.until=new Date(h)}else n.accept("for")&&(e.count=parseInt(n.value[0],10),n.expect("number"))}}const vt=(r,t)=>r.indexOf(t)!==-1,ue=r=>r.toString(),ye=(r,t,e)=>`${t} ${e}, ${r}`;class A{static IMPLEMENTED;rrule;text;gettext;dateFormatter;language;options;origOptions;bymonthday;byweekday;constructor(t,e=ue,n=st,i=ye){if(this.text=[],this.language=n||st,this.gettext=e,this.dateFormatter=i,this.rrule=t,this.options=t.options,this.origOptions=t.origOptions,this.origOptions.bymonthday){const s=[].concat(this.options.bymonthday),a=[].concat(this.options.bynmonthday);s.sort((o,c)=>o-c),a.sort((o,c)=>c-o),this.bymonthday=s.concat(a),this.bymonthday.length||(this.bymonthday=null)}if(U(this.origOptions.byweekday)){const s=_(this.origOptions.byweekday)?this.origOptions.byweekday:[this.origOptions.byweekday],a=String(s);this.byweekday={allWeeks:s.filter(c=>!c.n),someWeeks:s.filter(c=>!!c.n),isWeekdays:a.indexOf("MO")!==-1&&a.indexOf("TU")!==-1&&a.indexOf("WE")!==-1&&a.indexOf("TH")!==-1&&a.indexOf("FR")!==-1&&a.indexOf("SA")===-1&&a.indexOf("SU")===-1,isEveryDay:a.indexOf("MO")!==-1&&a.indexOf("TU")!==-1&&a.indexOf("WE")!==-1&&a.indexOf("TH")!==-1&&a.indexOf("FR")!==-1&&a.indexOf("SA")!==-1&&a.indexOf("SU")!==-1};const o=(c,d)=>c.weekday-d.weekday;this.byweekday.allWeeks.sort(o),this.byweekday.someWeeks.sort(o),this.byweekday.allWeeks.length||(this.byweekday.allWeeks=null),this.byweekday.someWeeks.length||(this.byweekday.someWeeks=null)}else this.byweekday=null}static isFullyConvertible(t){if(!(t.options.freq in A.IMPLEMENTED)||t.origOptions.until&&t.origOptions.count)return!1;for(const e in t.origOptions){if(vt(["dtstart","tzid","wkst","freq"],e))return!0;if(!vt(A.IMPLEMENTED[t.options.freq],e))return!1}return!0}isFullyConvertible(){return A.isFullyConvertible(this.rrule)}toString(){const t=this.gettext;if(!(this.options.freq in A.IMPLEMENTED))return t("RRule error: Unable to fully convert this rrule to text");if(this.text=[t("every")],this[f.FREQUENCIES[this.options.freq]](),this.options.until){this.add(t("until"));const e=this.options.until;this.add(this.dateFormatter(e.getUTCFullYear(),this.language.monthNames[e.getUTCMonth()],e.getUTCDate()))}else this.options.count&&this.add(t("for")).add(this.options.count.toString()).add(this.plural(this.options.count)?t("times"):t("time"));if(this.origOptions.dtstart){this.text.push(","),this.add(t("starting"));const e=this.origOptions.dtstart;this.add(this.dateFormatter(e.getUTCFullYear(),this.language.monthNames[e.getUTCMonth()],e.getUTCDate()))}return this.isFullyConvertible()||this.add(t("(~ approximate)")),this.text.join("")}HOURLY(){const t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("hours"):t("hour"))}MINUTELY(){const t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("minutes"):t("minute"))}DAILY(){const t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()),this.byweekday?.isWeekdays?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(this.plural(this.options.interval)?t("days"):t("day")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday?this._byweekday():this.origOptions.byhour&&this._byhour()}WEEKLY(){const t=this.gettext;this.options.interval!==1&&this.add(this.options.interval.toString()).add(this.plural(this.options.interval)?t("weeks"):t("week")),this.byweekday?.isWeekdays?this.options.interval===1?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(t("on")).add(t("weekdays")):this.byweekday?.isEveryDay?this.add(this.plural(this.options.interval)?t("days"):t("day")):(this.options.interval===1&&this.add(t("week")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.origOptions.byhour&&this._byhour())}MONTHLY(){const t=this.gettext;this.origOptions.bymonth?(this.options.interval!==1&&(this.add(this.options.interval.toString()).add(t("months")),this.plural(this.options.interval)&&this.add(t("in"))),this._bymonth()):(this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("months"):t("month"))),this.bymonthday?this._bymonthday():this.byweekday?.isWeekdays?this.add(t("on")).add(t("weekdays")):this.byweekday&&this._byweekday()}YEARLY(){const t=this.gettext;this.origOptions.bymonth?(this.options.interval!==1&&(this.add(this.options.interval.toString()),this.add(t("years"))),this._bymonth()):(this.options.interval!==1&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("years"):t("year"))),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.options.byyearday&&this.add(t("on the")).add(this.list(this.options.byyearday,this.nth,t("and"))).add(t("day")),this.options.byweekno&&this.add(t("in")).add(this.plural(this.options.byweekno.length)?t("weeks"):t("week")).add(this.list(this.options.byweekno,void 0,t("and")))}_bymonthday(){const t=this.gettext;this.byweekday?.allWeeks?this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext,t("or"))).add(t("the")).add(this.list(this.bymonthday,this.nth,t("or"))):this.add(t("on the")).add(this.list(this.bymonthday,this.nth,t("and")))}_byweekday(){const t=this.gettext;this.byweekday.allWeeks&&!this.byweekday.isWeekdays&&this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext)),this.byweekday.someWeeks&&(this.byweekday.allWeeks&&this.add(t("and")),this.add(t("on the")).add(this.list(this.byweekday.someWeeks,this.weekdaytext,t("and"))))}_byhour(){const t=this.gettext;this.add(t("at")).add(this.list(this.origOptions.byhour,void 0,t("and")))}_bymonth(){this.add(this.list(this.options.bymonth,this.monthtext,this.gettext("and")))}nth(t){let e;t=parseInt(t.toString(),10);const n=this.gettext;if(t===-1)return n("last");const i=Math.abs(t);switch(i){case 1:case 21:case 31:e=i+n("st");break;case 2:case 22:e=i+n("nd");break;case 3:case 23:e=i+n("rd");break;default:e=i+n("th")}return t<0?`${e} ${n("last")}`:e}monthtext(t){return this.language.monthNames[t-1]}weekdaytext(t){const e=W(t)?(t+1)%7:t.getJsWeekday();return(t.n?`${this.nth(t.n)} `:"")+this.language.dayNames[e]}plural(t){return t%100!=1}add(t){return this.text.push(" "),this.text.push(t),this}list(t,e,n,i=","){_(t)||(t=[t]),e=e||(a=>a.toString());const s=a=>e?.call(this,a);return n?((a,o,c)=>{let d="";for(let h=0;h<a.length;h++)h!==0&&(h===a.length-1?d+=` ${c} `:d+=`${o} `),d+=a[h];return d})(t.map(s),i,n):t.map(s).join(`${i} `)}}const Z=["count","until","interval","byweekday","bymonthday","bymonth"];A.IMPLEMENTED=[],A.IMPLEMENTED[k.HOURLY]=Z,A.IMPLEMENTED[k.MINUTELY]=Z,A.IMPLEMENTED[k.DAILY]=["byhour"].concat(Z),A.IMPLEMENTED[k.WEEKLY]=Z,A.IMPLEMENTED[k.MONTHLY]=Z,A.IMPLEMENTED[k.YEARLY]=["byweekno","byyearday"].concat(Z);const{isFullyConvertible:fe}=A;function Ut(r){const t=[],e=Object.keys(r);for(const n of e)ge.includes(n)||t.push(n),qt(r[n])&&!Q(r[n])&&t.push(n);if(t.length)throw new Error(`Invalid options: ${t.join(", ")}`);return{...r}}function ut(r){const t=r.split(`
`).map(me).filter(e=>e!==null);return{...t[0],...t[1]}}function rt(r){const t={},e=/DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\s]+)/i.exec(r);if(!e)return t;const[,n,i=""]=e;return n&&(t.tzid=n),t.dtstart=mt(i),t}function me(r){if(!(r=r.replace(/^\s+|\s+$/,"")).length)return null;const t=/^([A-Z]+?)[:;]/.exec(r.toUpperCase());if(!t)return Lt(r);const e=t[1];switch(e.toUpperCase()){case"RRULE":case"EXRULE":return Lt(r);case"DTSTART":return rt(r);default:throw new Error(`Unsupported RFC prop ${e} in ${r}`)}}function Lt(r){const t=rt(r.replace(/^RRULE:/i,""));return r.replace(/^(?:RRULE|EXRULE):/i,"").split(";").forEach(e=>{const[n="",i=""]=e.split("=");switch(n.toUpperCase()){case"FREQ":t.freq=k[i.toUpperCase()];break;case"WKST":t.wkst=N[i.toUpperCase()];break;case"COUNT":case"INTERVAL":case"BYSETPOS":case"BYMONTH":case"BYMONTHDAY":case"BYYEARDAY":case"BYWEEKNO":case"BYHOUR":case"BYMINUTE":case"BYSECOND":{const s=(function(o){return o.indexOf(",")!==-1?o.split(",").map(Ot):Ot(o)})(i),a=n.toLowerCase();t[a]=s;break}case"BYWEEKDAY":case"BYDAY":t.byweekday=(function(s){return s.split(",").map(o=>{if(o.length===2)return N[o];const c=o.match(/^([+-]?\d{1,2})([A-Z]{2})$/);if(!c||c.length<3)throw new SyntaxError(`Invalid weekday string: ${o}`);const d=Number(c[1]),h=c[2],u=N[h].weekday;return new L(u,d)})})(i);break;case"DTSTART":case"TZID":{const s=rt(r);t.tzid=s.tzid,t.dtstart=s.dtstart;break}case"UNTIL":t.until=mt(i);break;case"BYEASTER":t.byeaster=Number(i);break;default:throw new Error(`Unknown RRULE property '${n}'`)}}),t}function Ot(r){return/^[+-]?\d+$/.test(r)?Number(r):r}function yt(r){const t=[];let e="";const n=Object.keys(r),i=Object.keys(wt);for(const o of n){if(o==="tzid"||!i.includes(o))continue;let c=o.toUpperCase();const d=r[o];let h="";if(U(d)&&(!_(d)||d.length)){switch(c){case"FREQ":h=f.FREQUENCIES[r.freq];break;case"WKST":h=W(d)?new L(d).toString():d.toString();break;case"BYWEEKDAY":c="BYDAY",h=Bt(d).map(u=>u instanceof L?u:_(u)?new L(u[0],u[1]):new L(u)).toString();break;case"DTSTART":e=be(d,r.tzid);break;case"UNTIL":h=ft(d,!r.tzid);break;default:if(_(d)){const u=[];for(let l=0;l<d.length;l++)u[l]=String(d[l]);h=u.toString()}else h=String(d)}h&&t.push([c,h])}}const s=t.map(([o,c])=>`${o}=${c}`).join(";");let a="";return s!==""&&(a=`RRULE:${s}`),[e,a].filter(o=>!!o).join(`
`)}function be(r,t){return r?`DTSTART${new tt(new Date(r),t).toString()}`:""}class P{method;args;minDate=null;maxDate=null;_result=[];total=0;constructor(t,e){this.method=t,this.args=e,t==="between"?(this.maxDate=e.inc?e.before:new Date(e.before.getTime()-1),this.minDate=e.inc?e.after:new Date(e.after.getTime()+1)):t==="before"?this.maxDate=e.inc?e.dt:new Date(e.dt.getTime()-1):t==="after"&&(this.minDate=e.inc?e.dt:new Date(e.dt.getTime()+1))}accept(t){++this.total;const e=this.minDate&&t<this.minDate,n=this.maxDate&&t>this.maxDate;if(this.method==="between"){if(e)return!0;if(n)return!1}else if(this.method==="before"){if(n)return!1}else if(this.method==="after")return!!e||(this.add(t),!1);return this.add(t)}add(t){return this._result.push(t),!0}getValue(){const t=this._result;switch(this.method){case"all":case"between":return t;default:return t.length?t[t.length-1]:null}}clone(){return new P(this.method,this.args)}}class Yt extends P{iterator;constructor(t,e,n){super(t,e),this.iterator=n}add(t){return!!this.iterator(t,this._result.length)&&(this._result.push(t),!0)}}function pe(r,t){return Array.isArray(r)?!!Array.isArray(t)&&r.length===t.length&&r.every((e,n)=>e.getTime()===t[n].getTime()):r instanceof Date?t instanceof Date&&r.getTime()===t.getTime():r===t}class we{all=!1;before=[];after=[];between=[];_cacheAdd(t,e,n){e&&(e=e instanceof Date?dt(e):kt(e)),t==="all"?this.all=e:(n._value=e,this[t].length>64&&this[t].shift(),this[t].push(n))}_cacheGet(t,e){let n=!1;const i=e?Object.keys(e):[],s=a=>{for(let o=0;o<i.length;o++){const c=i[o];if(!pe(e[c],a[c]))return!0}return!1};if(t==="all")n=this.all;else for(const a of this[t])if(!i.length||!s(a)){n=a._value;break}if(n===!1&&this.all){const a=new P(t,e);for(const o of this.all)if(!a.accept(o))break;n=a.getValue(),this._cacheAdd(t,n,e)}return _(n)?kt(n):n instanceof Date?dt(n):n}}class pt{_cache;constructor(t=!1){this._cache=t?null:new we}_cacheGet(t,e){return!!this._cache&&this._cache._cacheGet(t,e)}_cacheAdd(t,e,n){if(this._cache)return this._cache._cacheAdd(t,e,n)}all(t){if(t)return this._iter(new Yt("all",{},t));let e=this._cacheGet("all");return e===!1&&(e=this._iter(new P("all",{})),this._cacheAdd("all",e)),e}between(t,e,n=!1,i){if(!Q(t)||!Q(e))throw new Error("Invalid date passed in to RRule.between");const s={before:e,after:t,inc:n};if(i)return this._iter(new Yt("between",s,i));let a=this._cacheGet("between",s);return a===!1&&(a=this._iter(new P("between",s)),this._cacheAdd("between",a,s)),a}before(t,e=!1){if(!Q(t))throw new Error("Invalid date passed in to RRule.before");const n={dt:t,inc:e};let i=this._cacheGet("before",n);return i===!1&&(i=this._iter(new P("before",n)),this._cacheAdd("before",i,n)),i}after(t,e=!1){if(!Q(t))throw new Error("Invalid date passed in to RRule.after");const n={dt:t,inc:e};let i=this._cacheGet("after",n);return i===!1&&(i=this._iter(new P("after",n)),this._cacheAdd("after",i,n)),i}count(){return this.all().length}}const N={MO:new L(0),TU:new L(1),WE:new L(2),TH:new L(3),FR:new L(4),SA:new L(5),SU:new L(6)},wt={freq:k.YEARLY,dtstart:null,interval:1,wkst:N.MO,count:null,until:null,tzid:null,bysetpos:null,bymonth:null,bymonthday:null,bynmonthday:null,byyearday:null,byweekno:null,byweekday:null,bynweekday:null,byhour:null,byminute:null,bysecond:null,byeaster:null},ge=Object.keys(wt);class f extends pt{origOptions;options;static FREQUENCIES=["YEARLY","MONTHLY","WEEKLY","DAILY","HOURLY","MINUTELY","SECONDLY"];static YEARLY=k.YEARLY;static MONTHLY=k.MONTHLY;static WEEKLY=k.WEEKLY;static DAILY=k.DAILY;static HOURLY=k.HOURLY;static MINUTELY=k.MINUTELY;static SECONDLY=k.SECONDLY;static MO=N.MO;static TU=N.TU;static WE=N.WE;static TH=N.TH;static FR=N.FR;static SA=N.SA;static SU=N.SU;constructor(t={},e=!1){super(e),this.origOptions=Ut(t);const{parsedOptions:n}=(function(i){const s={...wt,...Ut(i)};if(U(s.byeaster)&&(s.freq=f.YEARLY),!U(s.freq)||!f.FREQUENCIES[s.freq])throw new Error(`Invalid frequency: ${s.freq} ${i.freq}`);if(s.dtstart||(s.dtstart=new Date(new Date().setMilliseconds(0))),U(s.wkst)?W(s.wkst)||(s.wkst=s.wkst.weekday):s.wkst=f.MO.weekday,U(s.bysetpos)){W(s.bysetpos)&&(s.bysetpos=[s.bysetpos]);for(const a of s.bysetpos)if(a===0||!(a>=-366&&a<=366))throw new Error("bysetpos must be between 1 and 366, or between -366 and -1")}if(!(s.byweekno||O(s.byweekno)||O(s.byyearday)||s.bymonthday||O(s.bymonthday)||U(s.byweekday)||U(s.byeaster)))switch(s.freq){case f.YEARLY:s.bymonth||(s.bymonth=s.dtstart.getUTCMonth()+1),s.bymonthday=s.dtstart.getUTCDate();break;case f.MONTHLY:s.bymonthday=s.dtstart.getUTCDate();break;case f.WEEKLY:s.byweekday=[X(s.dtstart)]}if(U(s.bymonth)&&!_(s.bymonth)&&(s.bymonth=[s.bymonth]),U(s.byyearday)&&!_(s.byyearday)&&W(s.byyearday)&&(s.byyearday=[s.byyearday]),U(s.bymonthday))if(_(s.bymonthday)){const a=[],o=[];for(const c of s.bymonthday)c>0?a.push(c):c<0&&o.push(c);s.bymonthday=a,s.bynmonthday=o}else s.bymonthday<0?(s.bynmonthday=[s.bymonthday],s.bymonthday=[]):(s.bynmonthday=[],s.bymonthday=[s.bymonthday]);else s.bymonthday=[],s.bynmonthday=[];if(U(s.byweekno)&&!_(s.byweekno)&&(s.byweekno=[s.byweekno]),U(s.byweekday))if(W(s.byweekday))s.byweekday=[s.byweekday],s.bynweekday=null;else if(Tt(s.byweekday))s.byweekday=[L.fromStr(s.byweekday).weekday],s.bynweekday=null;else if(s.byweekday instanceof L)!s.byweekday.n||s.freq>f.MONTHLY?(s.byweekday=[s.byweekday.weekday],s.bynweekday=null):(s.bynweekday=[[s.byweekday.weekday,s.byweekday.n]],s.byweekday=null);else{const a=[],o=[];for(const c of s.byweekday)W(c)?a.push(c):Tt(c)?a.push(L.fromStr(c).weekday):!c.n||s.freq>f.MONTHLY?a.push(c.weekday):o.push([c.weekday,c.n]);s.byweekday=O(a)?a:null,s.bynweekday=O(o)?o:null}else s.bynweekday=null;return U(s.byhour)?W(s.byhour)&&(s.byhour=[s.byhour]):s.byhour=s.freq<f.HOURLY?[s.dtstart.getUTCHours()]:null,U(s.byminute)?W(s.byminute)&&(s.byminute=[s.byminute]):s.byminute=s.freq<f.MINUTELY?[s.dtstart.getUTCMinutes()]:null,U(s.bysecond)?W(s.bysecond)&&(s.bysecond=[s.bysecond]):s.bysecond=s.freq<f.SECONDLY?[s.dtstart.getUTCSeconds()]:null,{parsedOptions:s}})(t);this.options=n}static parseText(t,e){return Dt(t,e)}static fromText(t,e){return((n,i=st)=>new f(Dt(n,i)||void 0))(t,e)}static parseString=ut;static fromString(t){return new f(f.parseString(t)||void 0)}static optionsToString=yt;_iter(t){return jt(t,this.options)}toString(){return yt(this.origOptions)}toText(t,e,n){return((i,s,a,o)=>new A(i,s,a,o).toString())(this,t,e,n)}isFullyConvertibleToText(){return fe(this)}clone(){return new f(this.origOptions)}}class it extends pt{_rrule;_rdate;_exrule;_exdate;_dtstart;_tzid;constructor(t=!1){super(t),this._rrule=[],this._rdate=[],this._exrule=[],this._exdate=[]}dtstart(t){if(t!==void 0&&(this._dtstart=t),this._dtstart!==void 0)return this._dtstart;for(const e of this._rrule)if(e.origOptions.dtstart)return e.origOptions.dtstart}tzid(t){if(t!==void 0&&(this._tzid=t),this._tzid!==void 0)return this._tzid;for(const e of this._rrule)if(e.origOptions.tzid)return e.origOptions.tzid}_iter(t){return(function(e,n,i,s,a,o){const c={},d=e.accept;function h(l,y){i.forEach(m=>{m.between(l,y,!0).forEach(p=>{c[Number(p)]=!0})})}a.forEach(l=>{const y=new tt(l,o).rezonedDate();c[Number(y)]=!0}),e.accept=function(l){const y=Number(l);return Number.isNaN(y)?d.call(this,l):!(!c[y]&&(h(new Date(y-1),new Date(y+1)),!c[y]))||(c[y]=!0,d.call(this,l))},e.method==="between"&&(h(e.args.after,e.args.before),e.accept=function(l){const y=Number(l);return!!c[y]||(c[y]=!0,d.call(this,l))});for(const l of s){const y=new tt(l,o).rezonedDate();if(!e.accept(new Date(y.getTime())))break}n.forEach(l=>{jt(e,l.options)});const u=e._result;switch(J(u),e.method){case"all":case"between":return u;case"before":return u.length&&u[u.length-1]||null;default:return u.length&&u[0]||null}})(t,this._rrule,this._exrule,this._rdate,this._exdate,this.tzid())}rrule(t){Rt(t,this._rrule)}exrule(t){Rt(t,this._exrule)}rdate(t){Mt(t,this._rdate)}exdate(t){Mt(t,this._exdate)}rrules(){return this._rrule.map(t=>t.clone())}exrules(){return this._exrule.map(t=>t.clone())}rdates(){return this._rdate.map(t=>new Date(t.getTime()))}exdates(){return this._exdate.map(t=>new Date(t.getTime()))}valueOf(){let t=[];return!this._rrule.length&&this._dtstart&&(t=t.concat(yt({dtstart:this._dtstart}))),this._rrule.forEach(e=>{t=t.concat(e.toString().split(`
`))}),this._exrule.forEach(e=>{t=t.concat(e.toString().split(`
`).map(n=>n.replace(/^RRULE:/,"EXRULE:")).filter(n=>!/^DTSTART/.test(n)))}),this._rdate.length&&t.push(Ct("RDATE",this._rdate,this.tzid())),this._exdate.length&&t.push(Ct("EXDATE",this._exdate,this.tzid())),t}toString(){return this.valueOf().join(`
`)}clone(){const t=new it(!this._cache);for(const e of this._rrule)t.rrule(e.clone());for(const e of this._exrule)t.exrule(e.clone());for(const e of this._rdate)t.rdate(new Date(e.getTime()));for(const e of this._exdate)t.exdate(new Date(e.getTime()));return t}}function Rt(r,t){if(!(r instanceof f))throw new TypeError(`${String(r)} is not an instance of RRule`);const e=String(r);t.some(n=>String(n)===e)||t.push(r)}function Mt(r,t){if(!(r instanceof Date))throw new TypeError(`${String(r)} is not an instance of Date`);const e=r.getTime();t.some(n=>n.getTime()===e)||(t.push(r),J(t))}function Ct(r,t,e){const n=!e||e.toUpperCase()==="UTC";return`${n?`${r}:`:`${r};TZID=${e}:`}${t.map(i=>ft(i.valueOf(),n)).join(",")}`}const At={dtstart:null,cache:!1,unfold:!1,forceset:!1,compatible:!1,tzid:null};function ke(r,t){const e=[];let n=[];const i=[];let s=[];const a=rt(r),{dtstart:o}=a;let{tzid:c}=a;return(function(h,u=!1){if(h=h?.trim(),!h)throw new Error("Invalid empty string");if(!u)return h.split(/\s/);const l=h.split(`
`);let y=0;for(;y<l.length;){l[y]=l[y].replace(/\s+$/g,"");const m=l[y];m?y>0&&m[0]===" "?(l[y-1]+=m.slice(1),l.splice(y,1)):y+=1:l.splice(y,1)}return l})(r,t.unfold).forEach(h=>{if(!h)return;const{name:u,parms:l,value:y}=(function(m){const{name:p,value:E}=(function(b){if(b.indexOf(":")===-1)return{name:"RRULE",value:b};const[w="",D=""]=((T,v,B)=>{const M=T.split(v);return M.slice(0,B).concat([M.slice(B).join(v)])})(b,":",1);return{name:w,value:D}})(m),S=p.split(";");if(!S)throw new Error("empty property name");return{name:S[0].toUpperCase(),parms:S.slice(1),value:E}})(h);switch(u.toUpperCase()){case"RRULE":if(l.length)throw new Error(`unsupported RRULE parm: ${l.join(",")}`);e.push(ut(h));break;case"RDATE":{const[,m]=/RDATE(?:;TZID=([^:=]+))?/i.exec(h)??[];m&&!c&&(c=m),n=n.concat(It(y,l));break}case"EXRULE":if(l.length)throw new Error(`unsupported EXRULE parm: ${l.join(",")}`);i.push(ut(y));break;case"EXDATE":s=s.concat(It(y,l));break;case"DTSTART":break;default:throw new Error(`unsupported property: ${u}`)}}),{dtstart:o,tzid:c,rrulevals:e,rdatevals:n,exrulevals:i,exdatevals:s}}function Ft(r,t={}){return(function(e,n){const{rrulevals:i,rdatevals:s,exrulevals:a,exdatevals:o,dtstart:c,tzid:d}=ke(e,n),h=n.cache===!1;if(n.compatible&&(n.forceset=!0,n.unfold=!0),n.forceset||i.length>1||s.length||a.length||o.length){const l=new it(h);return l.dtstart(c),l.tzid(d||void 0),i.forEach(y=>{l.rrule(new f(ht(y,c,d),h))}),s.forEach(y=>{l.rdate(y)}),a.forEach(y=>{l.exrule(new f(ht(y,c,d),h))}),o.forEach(y=>{l.exdate(y)}),n.compatible&&n.dtstart&&l.rdate(c),l}const u=i[0]||{};return new f(ht(u,u.dtstart||n.dtstart||c,u.tzid||n.tzid||d),h)})(r,(function(e){const n=[],i=Object.keys(e),s=Object.keys(At);if(i.forEach(a=>{s.includes(a)||n.push(a)}),n.length)throw new Error(`Invalid options: ${n.join(", ")}`);return{...At,...e}})(t))}function ht(r,t,e){return{...r,dtstart:t,tzid:e}}function It(r,t){return(function(e){e.forEach(n=>{if(!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(n))throw new Error(`unsupported RDATE/EXDATE parm: ${n}`)})})(t),r.split(",").map(e=>mt(e))}function Ee(r,t){try{return Ft(r,t),{valid:!0}}catch(e){const n=e instanceof Error?e:new Error(String(e));return{valid:!1,error:{message:n.message,cause:n}}}}const Te=Object.freeze(Object.defineProperty({__proto__:null,ALL_WEEKDAYS:et,Frequency:k,RRule:f,RRuleBase:pt,RRuleSet:it,Weekday:L,datetime:F,rrulestr:Ft,validate:Ee},Symbol.toStringTag,{value:"Module"}));Object.assign(window,Te);const lt=r=>[f.MO,f.TU,f.WE,f.TH,f.FR,f.SA,f.SU][r],xe=r=>Array.isArray(r)?r:[r],Se=r=>{const t={},e=new FormData(r);for(const[n,i]of e.entries()){const s=n,a=i;if(Object.hasOwn(t,s)){const o=xe(t[s]);o.push(a),t[s]=o}else t[s]=a}return t},$t=r=>{const t=["RRule.MO","RRule.TU","RRule.WE","RRule.TH","RRule.FR","RRule.SA","RRule.SU"];return`{
  ${Object.keys(r).map(n=>{let i=r[n];if(i===null)i="null";else if(n==="freq")i=`RRule.${f.FREQUENCIES[i]}`;else if(n==="dtstart"||n==="until"){const s=i;i="new Date(Date.UTC("+[s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds()].join(", ")+"))"}else if(n==="byweekday")Array.isArray(i)?i=i.map(s=>{const a=t[s.weekday];return s.n?`${a}.nth(${s.n})`:a}):i=t[i.weekday];else if(n==="wkst"){if(i===f.MO)return"";i=t[i.weekday]}return Array.isArray(i)&&(i=`[${i.join(", ")}]`),`${n}: ${i}`}).filter(n=>!!n).join(`,
  `)}
}`},De=r=>{let t=[],e=[];return r.map((i,s)=>{const a=[],o=i.toUTCString().split(" "),c=o.map((d,h)=>(d!==t[h]?a[h]=!e[h]:a[h]=e[h],`<td class='${a[h]?"a":"b"}'>${d}</td>`));return t=o,e=a,`<tr><td>${s+1}</td>${c.join(`
`)}</tr>`}).join(`

`)},C=r=>document.querySelector(r),G=r=>Array.from(document.querySelectorAll(r));document.addEventListener("DOMContentLoaded",()=>{const r=C("#tabs"),t=o=>{const c=o.getAttribute("href")?.split("#")[1];for(const u of G("#tabs a"))u.classList.remove("active");o.classList.add("active");for(const u of G("#input-types section"))u.style.display="none";const d=C(`#input-types #${c}`);d.style.display="";const h=d.querySelector("input");h&&(h.focus(),h.dispatchEvent(new Event("change",{bubbles:!0})))};for(const o of G("#input-types section")){o.style.display="none";const c=o.querySelector("h3"),d=c.textContent;c.style.display="none";const h=document.createElement("a");h.href=`#${o.id}`,h.textContent=d,h.addEventListener("click",u=>{u.preventDefault(),t(h)}),r.appendChild(h)}for(const o of G(".examples code"))o.addEventListener("click",()=>{const d=o.closest("section").querySelector("input");d.value=o.textContent,d.dispatchEvent(new Event("change",{bubbles:!0}))});let e,n;const i=o=>{const c=o.target,h=c.closest("section").id.split("-")[0];switch(h){case"text":n=()=>f.fromText(c.value),e=`RRule.fromText("${c.value}")`;break;case"rfc":n=()=>f.fromString(c.value),e=`RRule.fromString("${c.value}")`;break;case"options":{const D=c.closest("form"),T=Se(D),v={};for(const B in T){const M=B;let x=T[M];if(x)switch(M){case"dtstart":case"until":{v[M]=new Date(Date.parse(`${x}Z`));continue}case"byweekday":Array.isArray(x)?v[M]=x.map(I=>lt(parseInt(I,10))):v[M]=lt(parseInt(x,10));continue;case"wkst":v[M]=lt(parseInt(x,10));continue;case"interval":{const I=parseInt(x,10);if(I===1||!x)continue;v[M]=I;continue}case"tzid":v[M]=x;continue;case"byweekno":case"byhour":case"byminute":case"bysecond":case"byyearday":case"bymonth":case"bymonthday":case"bysetpos":case"bynmonthday":Array.isArray(x)||(x=x.split(/[,\s]+/)),x=x.filter(I=>I),v[M]=x.map(I=>parseInt(I,10));continue;case"bynweekday":Array.isArray(x)||(x=x.split(/[,\s]+/)),x=x.filter(I=>I),v[M]=[x.map(I=>parseInt(I,10))];continue;case"byeaster":v[M]=parseInt(x,10);continue;case"freq":case"count":v[M]=parseInt(x,10);continue;default:continue}}n=()=>new f(v),e=`new RRule(${$t(v)})`;break}}C("#init").innerHTML=e,C("#rfc-output a").innerHTML="",C("#text-output a").innerHTML="",C("#options-output").innerHTML="",C("#dates").innerHTML="";let u;try{u=n()}catch(D){const T=document.createElement("pre");T.className="error",T.textContent=`=> ${String(D||null)}`,C("#init").appendChild(T);return}const l=u.toString(),y=u.toText(),m=C("#rfc-output a");m.textContent=l,m.href=`#/rfc/${l}`;const p=C("#text-output a");p.textContent=y,p.href=`#/text/${y}`,C("#options-output").textContent=$t(u.origOptions);const E=C("#options-output").closest("tr");h==="options"?E.style.display="none":E.style.display="";const S=500,b=u.all((D,T)=>!(!u.options.count&&T===S));let w=De(b);u.options.count||(w+=`<tr><td colspan='7'><em>Showing first ${S} dates, set <code>count</code> to see more.</em></td></tr>`),C("#dates").innerHTML=w};for(const o of G("input, select"))o.addEventListener("keyup",i),o.addEventListener("change",i);const s=r.querySelector("a");s&&t(s);const a=()=>{const o=location.hash.substring(1);if(o){const c=/^\/(rfc|text)\/(.+)$/.exec(o);if(c){const d=c[1],h=c[2],u=C(`a[href='#${d}-input']`);t(u);const l=C(`#${d}-input input`);l.value=h,l.dispatchEvent(new Event("change",{bubbles:!0}))}}};a(),window.addEventListener("hashchange",a)});
